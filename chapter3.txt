This is updated version of chapter 2